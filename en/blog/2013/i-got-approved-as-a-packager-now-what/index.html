<!DOCTYPE html>
<html>
   <head>
   <meta charset="utf-8">
       <title>I got approved as a packager, now what?</title>
       <meta charset="utf-8" />
       <meta name="viewport" content="width=device-width, initial-scale=1.0" />
       <meta http-equiv="Pragma" content="no-cache" />
       <meta http-equiv="Expires" content="-1" />
       <link rel="stylesheet" href="/theme/css/main.css" type="text/css" />
       <link rel="stylesheet" href="/theme/css/friendly.css" type="text/css" />
       <link rel="stylesheet" href="/theme/css/print.css" type="text/css" media="print" />
       <link rel="stylesheet" type="text/css" href="/theme/tipuesearch/tipuesearch.css" media="screen">
       <link rel="stylesheet" href="/theme/css/font-awesome.min.css" type="text/css" />
       <link href="http://axilleas.me/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Over the line RSS Feed" />
</head>
<body>
   <header>
       <h1><a href="/" title="Mark it zero">Over the line</a></h1>
       <nav>
         <a href="/about" title="about me">whoami</a> &bull;
         <a href="/archives.html" title="Archives">Archives</a> &bull;
         <a id="subscribe-link" href="/rss" title="RSS feed" rel="nofollow">subscribe</a>
         <form id="searchform" action="/search.html" onsubmit="return (this.elements['q'].value.length > 0)">
               <input id="searchbox" type="text" name="q" size="12" placeholder="Search">
         </form>
       </nav>
   </header>

   <div id="main">
<article>
    <header>
<h1><a href="/en/blog/2013/i-got-approved-as-a-packager-now-what" rel="bookmark">
    I got approved as a packager, now what?
</a></h1>
<span title="~1708 words" id='stats'>~7 min read</span>
&bull;
<time datetime="2013-07-21 00:00:00+03:00" pubdate>Posted on
    Sun 21 July 2013
</time>
<span class="category">in <a href="/category/opensource.html">
    opensource</a>
</span>
    <ul class="tags">
    Tags:
        <li><a href="/tag/fedora.html">fedora</a></li>
        <li><a href="/tag/packaging.html">packaging</a></li>
        <li><a href="/tag/fedpkg.html">fedpkg</a></li>
        <li><a href="/tag/bodhi.html">bodhi</a></li>
        <li><a href="/tag/git.html">git</a></li>
    </ul>
    </header>

    <div class="body">
        <p>This must have been the most intense week in terms of learning how the build 
system/process work in Fedora. I finally got approved as a packager and that means
more responsibility from my side. Unfortunately, the instrusctions in the wiki
are sometimes sparsed into different places and one has to read a lot and ask
around in order not to make any mistakes. For a newcomer all this information
is at least overwhelming and you have to even put a lot of thinking into asking
the right question in order to get the right answer.</p>
<p>I'm starting to believe that this is intentional as a continuous test to one's
understanding of how things work in Fedora. No pain no gain they say. </p>
<p>Anyway, I kinda managed to understand most of it and below I will describe the
process I followed hoping to help any future-to-be packagers. I will describe the
whole process of my first package submission including the outputs of many commands
that were new to me. <a href="https://fedoraproject.org/wiki/New_package_process_for_existing_contributors">This</a> wiki page sums it up, but read it after understanding 
the process. There is also a nice guide called <a href="http://shakthimaan.com/downloads/glv/howtos/packaging-rpm-workflow.html">packaging rpm workflow</a> that shows
the workflow of the whole process from the very beginning. Nice read.</p>
<p>With the kind help of the people at <code>#fedora-devel</code> I was able to pull it through, 
so thanks guys :)</p>
<div class="toc">
<ul>
<li><a href="#route-to-follow-after-your-approval">Route to follow after your approval</a><ul>
<li><a href="#scm-request">SCM request</a></li>
<li><a href="#commit-build-and-upload-your-package">Commit, build and upload your package</a><ul>
<li><a href="#steps-with-fedpkg-and-git">Steps with fedpkg and git</a></li>
<li><a href="#build-on-koji">Build on koji</a></li>
<li><a href="#submit-your-package-to-current-versions-of-fedora">Submit your package to current versions of Fedora</a></li>
<li><a href="#push-your-package-to-bodhi">Push your package to bodhi</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#faq">FAQ</a></li>
<li><a href="#epilogue">Epilogue</a></li>
</ul>
</div>
<h1 id="route-to-follow-after-your-approval">Route to follow after your approval</h1>
<p>Congratulations you promoted to a <a href="https://fedoraproject.org/wiki/How_to_get_sponsored_into_the_packager_group">packager</a>! After your approval, there are a
bunch of things to do, summarized into two big steps:</p>
<ol>
<li>Make a <a href="https://fedoraproject.org/wiki/Package_SCM_admin_requests">scm request</a> in your bugzilla review request</li>
<li>Use <code>fedpkg</code> to <a href="https://fedoraproject.org/wiki/Join_the_package_collection_maintainers#Add_Package_to_Source_Code_Management_.28SCM.29_system_and_Set_Owner">commit, build and upload your package</a></li>
</ol>
<p>Let's break it down.</p>
<h2 id="scm-request">SCM request</h2>
<p>Must read: <a href="https://fedoraproject.org/wiki/Package_SCM_admin_requests">Package SCM admin requests</a></p>
<p>For starters, scm stands for <em>Source Code Management</em>.
After your package approval, there are two steps as far as the Bugzilla concerns. </p>
<ol>
<li>set fedora-cvs flag to ?</li>
<li>
<p>Make a new comment including the following form completed:</p>
<div class="codehilite"><pre><span class="gh">New Package SCM Request</span>
<span class="gh">=======================</span>
Package Name: 
Short Description: 
Owners: 
Branches: 
InitialCC:
</pre></div>


</li>
<li>
<p>Hit <code>Save Changes</code> to save both 1 and 2. See <a href="https://bugzilla.redhat.com/show_bug.cgi?id=982679">how</a> I did it.</p>
</li>
</ol>
<p><strong>Note:</strong> Let me tell you a little secret if you are new to bugzilla like I am. Make any
changes you need to, even leave a comment and then hit <code>Save Changes</code> to save ALL
the changes you've made. There are two buttons for this: one in the upper right
corner and one below the <code>Additional Comments</code> form. Either one will do just fine.
This may sound stupid but I wansn't aware of it, so I first left a comment and then
changed the flag, resulting to send a mail update twice.</p>
<h2 id="commit-build-and-upload-your-package">Commit, build and upload your package</h2>
<p>Must read: <a href="https://fedoraproject.org/wiki/Join_the_package_collection_maintainers#Add_Package_to_Source_Code_Management_.28SCM.29_system_and_Set_Owner">Add Package to Source Code Management (SCM) system and Set Owner</a></p>
<p>After the scm request, you will receive some e-mails from Bugzilla and PackageDB
stating that you are good to go. If you visit <a href="http://pkgs.fedoraproject.org/cgit/">cgit</a> you will see your bare repository.</p>
<p><img alt="Bare repo" src="http://axilleas.me/images/rubygem-bootstrap-sass.git-bare-2013-07-20-14-28-50.png" /></p>
<p>The whole building process works using <code>fedpkg</code> and git commands, so if you are
not familiar with git, I suggest the <a href="https://fedoraproject.org/wiki/Using_git_FAQ_for_package_maintainers">Fedora wiki page</a>. For a more
comprehensive approach I highly recommend the <a href="http://git-scm.com/book">Pro Git book</a>.</p>
<h3 id="steps-with-fedpkg-and-git">Steps with fedpkg and git</h3>
<ol>
<li>
<p>Create a directory to have all your package builds neat and tidy.</p>
<div class="codehilite"><pre>mkdir ~/fedora-scm
<span class="nb">cd</span> ~/fedora-scm
</pre></div>


</li>
<li>
<p>Clone the newly created git repository.</p>
<div class="codehilite"><pre>fedpkg clone rubygem-bootstrap-sass
<span class="nb">cd </span>rubygem-bootstrap-sass
</pre></div>


<p>The contents of git config are:</p>
<div class="codehilite"><pre><span class="k">[core]</span>
  <span class="na">repositoryformatversion</span> <span class="o">=</span> <span class="s">0</span>
<span class="s">  filemode = true</span>
<span class="s">  bare = false</span>
<span class="s">  logallrefupdates = true</span>
<span class="k">[remote &quot;origin&quot;]</span>
  <span class="na">url</span> <span class="o">=</span> <span class="s">ssh://axilleas@pkgs.fedoraproject.org/rubygem-bootstrap-sass</span>
<span class="s">  fetch = +refs/heads/*:refs/remotes/origin/*</span>
<span class="k">[branch &quot;master&quot;]</span>
 <span class="na">remote</span> <span class="o">=</span> <span class="s">origin</span>
<span class="s"> merge = refs/heads/master</span>
</pre></div>


</li>
<li>
<p>Import the src.rpm:</p>
<div class="codehilite"><pre>fedpkg import /var/lib/mock/fedora-rawhide-x86_64/results/rubygem-bootstrap-sass-f20.src.rpm
</pre></div>


<p>You should see something like this:</p>
<div class="codehilite"><pre>Uploading: 4f0c887ea7cd95812edcc6b8b01b9329  bootstrap-sass-2.3.2.1.gem
<span class="c">######################################################################## 100.0%</span>
Uploaded and added to .gitignore: bootstrap-sass-2.3.2.1.gem
...
diff status of all files to be commited
...
New content staged and new sources uploaded.
Commit <span class="k">if</span> happy or revert with: git reset --hard HEAD
</pre></div>


<p>Now we have 3 files in our directory:</p>
<div class="codehilite"><pre>-r--r--r--. 1 axil axil 86528 Jul 20 15:30 bootstrap-sass-2.3.2.1.gem
-rw-r--r--. 1 axil axil  2314 Jul 20 15:30 rubygem-bootstrap-sass.spec
-rw-r--r--. 1 axil axil    61 Jul 20 15:30 sources
</pre></div>


<p>sources is a text file with the source package (gem) and its md5 hash.
Notice that the gem name was automatically placed to the <code>.gitignore</code>.
Running <code>git status</code> we see that there are 3 files in the <a href="http://git-scm.com/about/staging-area">staging area</a>.</p>
<div class="codehilite"><pre># On branch master
# Changes to be committed:
#   (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)
#
#       modified:   .gitignore
#       new file:   rubygem-bootstrap-sass.spec
#       modified:   sources
#
</pre></div>


<p>If you are indeed happy with the changes, commit them and push to master (rawhide) branch.
Use the bugzilla id from your review request. No scripts are parsing this, it is just for reference.</p>
<div class="codehilite"><pre><span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s">&quot;Initial import (#982679).&quot;</span>
<span class="n">git</span> <span class="n">push</span>
</pre></div>


<p>Now, if you visit again the cgit web page, you will see that the changes are submitted.</p>
<p><img alt="Bare repo" src="http://axilleas.me/images/rubygem-bootstrap-sass.git-init-2013-07-20-15-58-58.png" /></p>
</li>
</ol>
<h3 id="build-on-koji">Build on koji</h3>
<p>Lastly, give this command to start a build on <a href="https://fedoraproject.org/wiki/Koji">koji</a>:</p>
<div class="codehilite"><pre>fedpkg build
</pre></div>


<p>Output:</p>
<div class="codehilite"><pre>Building rubygem-bootstrap-sass-2.3.2.1-1.fc20 for rawhide
Created task: 5631690
Task info: http://koji.fedoraproject.org/koji/taskinfo?taskID=5631690
Watching tasks (this may be safely interrupted)...
5631690 build (rawhide, /rubygem-bootstrap-sass:md5): open (arm02-builder11.arm.fedoraproject.org)
5631691 buildSRPMFromSCM (/rubygem-bootstrap-sass:md5): open (buildvm-25.phx2.fedoraproject.org)
5631716 buildArch (rubygem-bootstrap-sass-2.3.2.1-1.fc20.src.rpm, noarch): open (buildvm-01.phx2.fedoraproject.org)
5631691 buildSRPMFromSCM (/rubygem-bootstrap-sass:md5): open (buildvm-25.phx2.fedoraproject.org) -&gt; closed
0 free  2 open  1 done  0 failed
5631716 buildArch (rubygem-bootstrap-sass-2.3.2.1-1.fc20.src.rpm, noarch): open (buildvm-01.phx2.fedoraproject.org) -&gt; closed
0 free  1 open  2 done  0 failed
5631737 tagBuild (noarch): closed
5631690 build (rawhide, /rubygem-bootstrap-sass:md5): open (arm02-builder11.arm.fedoraproject.org) -&gt; closed
0 free  0 open  4 done  0 failed

5631690 build (rawhide, /rubygem-bootstrap-sass:054f742970e4b930bc55a5d3802fb31d26c57d0d) completed successfully
</pre></div>


<p>A notification mail will be sent to you once the build is complete and the
package will appear automagically at rawhide repos. If you want to push a
package to a stable version of Fedora, keep reading.</p>
<h3 id="submit-your-package-to-current-versions-of-fedora">Submit your package to current versions of Fedora</h3>
<p>This step is optional if you want to maintain other versions than rawhide.
Switch to the corresponding version branch with <code>fx</code>, where <code>x</code> the version of Fedora:</p>
<div class="codehilite"><pre>fedpkg switch-branch f19
</pre></div>


<p>Running <code>git branch -r</code> reveals our branches so far:</p>
<div class="codehilite"><pre>origin/HEAD -&gt; origin/master
origin/f19
origin/master
</pre></div>


<p><strong>Tip:</strong> I suggest you use a shell where it shows you the branch you are in.
I recommend zsh and if you look at <a href="https://github.com/robbyrussell/oh-my-zsh">oh-my-zsh</a>, almost all themes included
support this. Mine for example is: </p>
<p><img alt="My zsh theme" src="http://axilleas.me/images/zsh-git-branch.png" /></p>
<p>Get the changes from master branch, push and build like before:</p>
<div class="codehilite"><pre>git merge master
git push
fedpkg build
</pre></div>


<h3 id="push-your-package-to-bodhi">Push your package to bodhi</h3>
<p>If your local machine's username is the same as your FAS one, skip this step.
This option is hidden from the wiki guide, I spoted it <a href="https://fedoraproject.org/wiki/Package_update_HOWTO#Submit_your_update_to_Bodhi">here</a>.</p>
<div class="codehilite"><pre><span class="nb">echo</span> <span class="s2">&quot;export BODHI_USER=axilleas &gt;&gt; ~/.zshrc&quot;</span>
<span class="nb">source</span> ~/.zshrc
</pre></div>


<p>Replace <code>.zshrc</code> with your shell's rc.</p>
<p>The final step is to submit your package to bodhi in order to be processed and
reach the repositories. You have two options: either via terminal or via the webui 
of bodhi. Choose what fits you best.</p>
<p>If you prefer the webui method then go to <a href="https://admin.fedoraproject.org/updates/new/">this link</a>, login and fill
in the blanks.</p>
<p>There are tooltips for each section explaining what should be filled,
but let's take a look:</p>
<table>
<thead>
<tr>
<th align="left">Description</th>
<th align="left">Option</th>
<th align="left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Package</td>
<td align="left">rubygem-bootstrap-sass</td>
<td align="left">Start typing your package name and it will autocomplete</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">newpackage</td>
<td align="left">Since this is the first package I chose newpackage</td>
</tr>
<tr>
<td align="left">Request</td>
<td align="left">Testing</td>
<td align="left">For the package to first land in updates-testing before goes in stable(recommended)</td>
</tr>
<tr>
<td align="left">Bugs</td>
<td align="left">982679</td>
<td align="left">The bugzilla id of your review request. This way it will change its status automatically</td>
</tr>
<tr>
<td align="left">Notes</td>
<td align="left">Package description</td>
<td align="left">Additional notes, eg. why you made this update, what are the bugfixes if it is a bugfix, etc.</td>
</tr>
<tr>
<td align="left">Suggest Reboot</td>
<td align="left">untick</td>
<td align="left">Recommend that the user restart their machines after they install this update</td>
</tr>
<tr>
<td align="left">Enable karma</td>
<td align="left">tick</td>
<td align="left">Enable update request automation based on <a href="https://fedoraproject.org/wiki/QA:Update_feedback_guidelines">user feedback</a></td>
</tr>
<tr>
<td align="left">Threshold to stable</td>
<td align="left">3</td>
<td align="left">This is the defaul value. It needs 3 points to get to stable repos</td>
</tr>
<tr>
<td align="left">Threshold for unpushing</td>
<td align="left">-3</td>
<td align="left">If it gets 3 points it rejects the package from testing</td>
</tr>
</tbody>
</table>
<p>Your other option is to do the update through terminal. This only works with branches
other than rawhide. If you try to push to rawhide, <code>fedpkg</code> will warn you.</p>
<p>When you issue the command below, you will have to edit a template using the default
system editor which is <code>vi</code>. If you have a different preference eg. <code>vim</code>, use
the export command. While in <code>f19</code> branch:</p>
<div class="codehilite"><pre><span class="nb">export </span><span class="nv">EDITOR</span><span class="o">=</span>vim
fedpkg update
</pre></div>


<p>The template is this:</p>
<div class="codehilite"><pre><span class="k">[ rubygem-bootstrap-sass-2.3.2.1-1.fc19 ]</span>

<span class="c1"># bugfix, security, enhancement, newpackage (required)</span>
<span class="na">type</span><span class="o">=</span>

<span class="c1"># testing, stable</span>
<span class="na">request</span><span class="o">=</span><span class="s">testing</span>

<span class="c1"># Bug numbers: 1234,9876</span>
<span class="na">bugs</span><span class="o">=</span>

<span class="c1"># Description of your update</span>
<span class="na">notes</span><span class="o">=</span><span class="s">Here is where you give an explanation of your update.</span>

<span class="c1"># Enable request automation based on the stable/unstable karma thresholds</span>
<span class="na">autokarma</span><span class="o">=</span><span class="s">True</span>
<span class="na">stable_karma</span><span class="o">=</span><span class="s">3</span>
<span class="na">unstable_karma</span><span class="o">=</span><span class="s">-3</span>

<span class="c1"># Automatically close bugs when this marked as stable</span>
<span class="na">close_bugs</span><span class="o">=</span><span class="s">True</span>

<span class="c1"># Suggest that users restart after update</span>
<span class="na">suggest_reboot</span><span class="o">=</span><span class="s">False</span>
</pre></div>


<p>Once you make all the appropriate changes, save it and close it. You will be
asked your FAS password to complete the process and you will get a similar output:</p>
<div class="codehilite"><pre>================================================================================
     rubygem-bootstrap-sass-2.3.2.1-1.fc19
================================================================================
    Release: Fedora 19
     Status: pending
       Type: newpackage
      Karma: 0
       Bugs: 982679 - Review Request: rubygem-bootstrap-sass - Twitter&#39;s
           : Bootstrap, converted to Sass and ready to drop into
           : Rails or Compass
      Notes: Initial commit
  Submitter: axilleas
  Submitted: 2013-07-20 15:20:18

  https://admin.fedoraproject.org/updates/rubygem-bootstrap-sass-2.3.2.1-1.fc19
</pre></div>


<p>After the submission, your package will go through these <a href="https://fedoraproject.org/wiki/Bodhi#Package_States">states</a>.</p>
<h1 id="faq">FAQ</h1>
<p>Here are some questions that I had during this process and their answers from
people in <code>#fedora-devel</code> which I thank them once again.</p>
<p><strong>Q:</strong> During <code>fedpkg import src.rpm</code>, do I need to provide a <code>foo-f20.src.rpm</code> or <code>foo-f19.src.rpm</code> will work too?</p>
<p><strong>A:</strong> You can virtually take any valid fedora/rhel srpm regardless on which version it was created.</p>
<p><strong>Q:</strong> What if I accidentally run <code>fedpkg update</code> for rawhide (master branch)?</p>
<p><strong>A:</strong> New versions of fedpkg should refuse.</p>
<p><strong>Q:</strong> If in a package review the spec's release version was bumped, should I revert the release to 1 prior to pushing in cgit?</p>
<p><strong>A:</strong> No, it is not needed.</p>
<h1 id="epilogue">Epilogue</h1>
<p>This was quite an adventure and I learned a lot. I am sure this is only the tip
of the iceberg and there's a lot more to come. This post took me literally one
day to compose as I was virtually recording the process as I performed it, hope
it was worth it. If you find any mistake or you want to add something please do
leave a comment. Next big article the Rubygem packaging How to ;)</p>
<p>Cheers!</p>
    </div>

    <div class="neighbors"></div>

      <nav class="older">
          <a href="http://axilleas.me/en/blog/2013/gsoc-weekly-update-3-and-4">
              <span class="lpin"></span>
              GSoC - Weekly update 3 and 4
          </a>
      </nav>

      <nav class="newer">
          <a href="http://axilleas.me/en/blog/2013/gsoc-weekly-update-5">
              GSoC - Weekly update 5
              <span class="rpin"></span>
          </a>
      </nav>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'kissmyarch';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></article>
   </div>

   <footer>
       <p>Powered by <a href="http://docs.getpelican.com">
           Pelican</a> using <a href="https://github.com/axilleas/pelican-uberspot">uberspot theme</a> &bull;
         Background image from <a href="http://subtlepatterns.com/">Subtle patterns</a> &bull;
               <a href="https://github.com/axilleas/axilleas.github.io/tree/source" title="Source code">Source code</a>
</p>


 <p><a id="cc-logo" title="Creative Commons License"
 rel="license" href="http://creativecommons.org/licenses/by/4.0/"></a>
 Except where otherwise noted, content on this site is licensed under a<br />
 <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>

   </footer>
  <!-- Piwik -->
  <script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="//piwik2-glb.rhcloud.com/";
      _paq.push(['setTrackerUrl', u+'piwik.php']);
      _paq.push(["setSiteId", "5"]);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <noscript><p><img src="//piwik2-glb.rhcloud.com/piwik.php?idsite=5" style="border:0;" alt="" /></p></noscript>
  <!-- End Piwik Code -->
</body>
</html>